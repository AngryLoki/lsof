head	1.10;
access;
symbols;
locks; strict;
comment	@ * @;


1.10
date	2001.08.09.11.44.07;	author abe;	state Exp;
branches;
next	1.9;

1.9
date	100.01.14.09.02.17;	author abe;	state Exp;
branches;
next	1.8;

1.8
date	99.05.09.17.24.02;	author abe;	state Exp;
branches;
next	1.7;

1.7
date	99.05.09.14.56.21;	author abe;	state Exp;
branches;
next	1.6;

1.6
date	99.05.04.09.01.54;	author abe;	state Exp;
branches;
next	1.5;

1.5
date	99.04.27.15.50.19;	author abe;	state Exp;
branches;
next	1.4;

1.4
date	98.11.23.07.39.45;	author abe;	state Exp;
branches;
next	1.3;

1.3
date	98.03.18.14.38.58;	author abe;	state Exp;
branches;
next	1.2;

1.2
date	97.04.16.07.54.22;	author abe;	state Exp;
branches;
next	1.1;

1.1
date	97.02.24.07.37.15;	author abe;	state Exp;
branches;
next	;


desc
@Lsof version 4
@


1.10
log
@Revision 4.58
@
text
@/*
 * dstore.c - NEXTSTEP and OPENSTEP global storage for lsof
 */


/*
 * Copyright 1994 Purdue Research Foundation, West Lafayette, Indiana
 * 47907.  All rights reserved.
 *
 * Written by Victor A. Abell
 *
 * This software is not subject to any license of the American Telephone
 * and Telegraph Company or the Regents of the University of California.
 *
 * Permission is granted to anyone to use this software for any purpose on
 * any computer system, and to alter it and redistribute it freely, subject
 * to the following restrictions:
 *
 * 1. Neither the authors nor Purdue University are responsible for any
 *    consequences of the use of this software.
 *
 * 2. The origin of this software must not be misrepresented, either by
 *    explicit claim or by omission.  Credit to the authors and Purdue
 *    University must appear in documentation and sources.
 *
 * 3. Altered versions must be plainly marked as such, and must not be
 *    misrepresented as being the original software.
 *
 * 4. This notice may not be removed or altered.
 */

#ifndef lint
static char copyright[] =
"@@(#) Copyright 1994 Purdue Research Foundation.\nAll rights reserved.\n";
static char *rcsid = "$Id: dstore.c,v 1.9 100/01/14 09:02:17 abe Exp abe $";
#endif


#include "lsof.h"


/*
 * Global storage definitions
 */

#if	defined(HAS_AFS)

# if    defined(HASAOPT)
char *AFSApath = (char *)NULL;		/* alternate AFS name list path
					 * (from -a) */
# endif /* defined(HASAOPT) */

struct vfs *AFSVfsp = (struct vfs *)NULL;
					/* AFS vfs struct kernel address */
#endif	/* defined(HAS_AFS) */

/*
 * Drive_Nl -- table to drive the building of Nl[] via build_Nl()
 *             (See lsof.h and misc.c.)
 */

struct drive_Nl Drive_Nl[] = {
        { "arFid",	 "_afs_rootFid"		},
        { "avops",	 "_afs_vnodeops"	},
        { "avol",	 "_afs_volumes"		},
        { "aproc",	 "_allproc"		},
        { "fvops",	"_fifo_vnodeops"	},
        { "lfsvh",	"_lf_svnode_hash"	},
        { "mxproc",	 "_max_proc"		},

#if	defined(X_NCACHE)
        { X_NCACHE,	 "_ncache"		},
#endif	/* defined(X_NCACHE) */

#if	defined(X_NCSIZE)
        { X_NCSIZE,	 "_ncsize"		},
#endif	/* defined(X_NCSIZE) */

        { "nvops",	 "_nfs_vnodeops"	},
        { "svops",	 "_spec_vnodeops"	},
        { "uvops",	 "_ufs_vnodeops"	},
	{ "",		"",			},
        { NULL,		NULL			},
};

struct file *Fileptr;		/* for process_file() in lib/prfp.c */
int Kd = -1;			/* /dev/kmem file descriptor */

#if	defined(HASFSTRUCT)
/*
 * Pff_tab[] - table for printing file flags
 */

struct pff_tab Pff_tab[] = {
	{ (long)FREAD,		FF_READ		},
	{ (long)FWRITE,		FF_WRITE	},
	{ (long)FNDELAY,	FF_NDELAY	},
	{ (long)FAPPEND,	FF_APPEND	},
	{ (long)FASYNC,		FF_ASYNC	},
	{ (long)FMARK,		FF_MARK		},
	{ (long)FDEFER,		FF_DEFER	},
	{ (long)FSHLOCK,	FF_SHLOCK	},
	{ (long)FEXLOCK,	FF_EXLOCK	},

#if	defined(POSIX_KERN)
	{ (long)FPOSIX_PIPE,	FF_POSIX_PIPE	},
#endif	/* defined(POSIX_KERN) */

	{ (long)0,		NULL		}
};


/*
 * Pof_tab[] - table for print process open file flags
 */

struct pff_tab Pof_tab[] = {

# if	defined(UF_EXCLOSE)
	{ (long)UF_EXCLOSE,	POF_CLOEXEC	},
# endif	/* defined(UF_EXCLOSE) */

# if	defined(UF_MAPPED)
	{ (long)UF_MAPPED,	POF_MAPPED	},
# endif	/* defined(UF_MAPPED) */

# if	defined(UF_FDLOCK)
	{ (long)UF_FDLOCK,	POF_FDLOCK	},
# endif	/* defined(UF_FDLOCK) */

	{ (long)0,		NULL		}
};
#endif	/* defined(HASFSTRUCT) */
@


1.9
log
@Revision 4.48
Correct comment spacing.
@
text
@d2 1
a2 1
 * dstore.c - NEXTSTEP and OpenStep global storage for lsof
d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.8 99/05/09 17:24:02 abe Exp Locker: abe $";
@


1.8
log
@Revision 4.43
@
text
@d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.7 99/05/09 14:56:21 abe Exp Locker: abe $";
d54 1
a54 1
				/* AFS vfs struct kernel address */
@


1.7
log
@Revision 4.43
@
text
@d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.6 99/05/04 09:01:54 abe Exp Locker: abe $";
d119 11
a129 5
# if	defined(FD_CLOEXEC)
	{ (long)FD_CLOEXEC,	POF_CLOEXEC	},
# else	/* !defined(FD_CLOEXEC) */
	{ (long)1,		POF_CLOEXEC	},
# endif	/* defined(FD_CLOEXEC) */
@


1.6
log
@Revision 4.43
@
text
@d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.5 99/04/27 15:50:19 abe Exp Locker: abe $";
d108 16
@


1.5
log
@Revision 4.43
@
text
@d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.4 98/11/23 07:39:45 abe Exp Locker: abe $";
d95 9
a103 9
	{ (long)FREAD,		"R"	},
	{ (long)FWRITE,		"W"	},
	{ (long)FNDELAY,	"ND"	},
	{ (long)FAPPEND,	"AP"	},
	{ (long)FASYNC,		"ASYN"	},
	{ (long)FMARK,		"MK"	},
	{ (long)FDEFER,		"DF"	},
	{ (long)FSHLOCK,	"SL"	},
	{ (long)FEXLOCK,	"XL"	},
d106 1
a106 1
	{ (long)FPOSIX_PIPE,	"PP" },
d109 1
a109 1
	{ (long)0,		NULL }
@


1.4
log
@Revision 4.38
@
text
@d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.3 98/03/18 14:38:58 abe Exp Locker: abe $";
d88 24
@


1.3
log
@Revision 4.29
Remove Lvfs pointer to l_vfs structure.
@
text
@d2 1
a2 1
 * dstore.c - NEXTSTEP global storage for lsof
d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.2 97/04/16 07:54:22 abe Exp Locker: abe $";
@


1.2
log
@Revision 4.04
@
text
@d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.1 97/02/24 07:37:15 abe Exp Locker: abe $";
a87 1
struct l_vfs *Lvfs = NULL;	/* local vfs structure table */
@


1.1
log
@Initial revision
@
text
@d35 1
a35 1
static char *rcsid = "$Id: dstore.c,v 1.9 96/12/28 11:30:13 abe Exp $";
d86 1
a86 1
struct file *Fileptr;		/* for process_file() in prfp.frag */
@
