head	1.13;
access;
symbols;
locks; strict;
comment	@# @;


1.13
date	2008.04.15.13.30.50;	author abe;	state Exp;
branches;
next	1.12;

1.12
date	2001.11.01.20.26.44;	author abe;	state Exp;
branches;
next	1.11;

1.11
date	99.11.28.06.44.28;	author abe;	state Exp;
branches;
next	1.10;

1.10
date	99.04.19.14.39.04;	author abe;	state Exp;
branches;
next	1.9;

1.9
date	99.02.25.20.00.29;	author abe;	state Exp;
branches;
next	1.8;

1.8
date	99.02.15.13.47.58;	author abe;	state Exp;
branches;
next	1.7;

1.7
date	99.02.08.15.25.09;	author abe;	state Exp;
branches;
next	1.6;

1.6
date	98.02.16.19.55.02;	author abe;	state Exp;
branches;
next	1.5;

1.5
date	97.05.22.14.37.39;	author abe;	state Exp;
branches;
next	1.4;

1.4
date	97.04.29.14.16.12;	author abe;	state Exp;
branches;
next	1.3;

1.3
date	97.04.29.08.26.06;	author abe;	state Exp;
branches;
next	1.2;

1.2
date	97.03.06.13.03.25;	author abe;	state Exp;
branches;
next	1.1;

1.1
date	97.02.24.07.46.48;	author abe;	state Exp;
branches;
next	;


desc
@Lsof version 4
@


1.13
log
@Revision 4.79
@
text
@
# Sun Makefile
#
# $Id: Makefile,v 1.12 2001/11/01 20:26:44 abe Exp abe $

PROG=	lsof

I=/usr/include
S=/usr/include/sys
L=/usr/include/local
P=

CDEF=
CDEFS=  ${CDEF} ${CFGF}
INCL=	${DINC}
CFLAGS=	${CDEFS} ${INCL} ${DEBUG}

HDR=    lsof.h lsof_fields.h dlsof.h machine.h proto.h dproto.h

SRC=    ddev.c dfile.c dmnt.c dnode.c dnode1.c dnode2.c dproc.c dsock.c \
	dstore.c \
	arg.c main.c misc.c node.c print.c proc.c store.c usage.c util.c

OBJ=	ddev.o dfile.o dmnt.o dnode.o dnode1.o dnode2.o dproc.o dsock.o \
	dstore.o \
	arg.o main.o misc.o node.o print.o proc.o store.o usage.o util.o

MAN=	lsof.8

OTHER=	

SHELL=	/bin/sh

SOURCE=	Makefile ${OTHER} ${MAN} ${HDR} ${SRC}

all: ${PROG}

${PROG}: ${LIB} ${P} ${OBJ}
	${CC} -o $@@ ${CFLAGS} ${OBJ} ${CFGL}

clean: FRC
	rm -f Makefile.bak ${PROG} a.out core errs lint.out tags *.o version.h
	rm -f machine.h.old new_machine.h
	(cd lib; ${MAKE} -f Makefile.skel clean)

install: all FRC
	@@echo ''
	@@echo 'Please write your own install rule.  Lsof should be installed'
	@@echo 'setgid to the group that can can read /dev/kmem.  Normally'
	@@echo 'that is the kmem (SunOS) or sys (Solaris) group.  Your SunOS'
	@@echo 'install rule actions might look something like this:'
	@@echo ''
	@@echo '  install <options> -m 2755 -g kmem ${PROG} <bin_dest>'
	@@echo '  install <options> -m 444 ${MAN} <man_dest>'
	@@echo ''
	@@echo 'Your Solaris install rule actions might look something like
	@@echo 'this:'
	@@echo ''
	@@echo '  install -[cf] <bin_dest> <options> -m 2755 -g sys ${PROG}'
	@@echo '  install -[cf] <man_dest> <options> -m 444 ${MAN}'
	@@echo ''
	@@echo 'You may have to put additional values in <options>, as required'
	@@echo 'by the install application in your version of SunOS or Solaris.'
	@@echo 'You will have to set the appropriate destination for the lsof'
	@@echo 'executable in <bin_dest>; the appropriate destination for the'
	@@echo 'man page in <man_dest>.'
	@@echo ''

${LIB}: FRC
	(cd lib; ${MAKE} DEBUG="${DEBUG}" CFGF="${CFGF}")

version.h:	FRC
	@@echo Constructing version.h
	@@rm -f version.h
	@@echo '#define	LSOF_BLDCMT	"${LSOF_BLDCMT}"' > version.h;
	@@echo '#define	LSOF_CC		"${CC}"' >> version.h
	@@echo '#define	LSOF_CCV	"${CCV}"' >> version.h
	@@echo '#define	LSOF_CCDATE	"'`date`'"' >> version.h
	@@echo '#define	LSOF_CCFLAGS	"'`echo ${CFLAGS} | sed 's/\\\\(/\\(/g' | sed 's/\\\\)/\\)/g' | sed 's/"/\\\\"/g'`'"' >> version.h
	@@echo '#define	LSOF_CINFO	"${CINFO}"' >> version.h
	@@if [ "X${LSOF_HOST}" = "X" ]; then \
	  echo '#define	LSOF_HOST	"'`uname -n`'"' >> version.h; \
	else \
	  if [ "${LSOF_HOST}" = "none" ]; then \
	    echo '#define	LSOF_HOST	""' >> version.h; \
	  else \
	    echo '#define	LSOF_HOST	"${LSOF_HOST}"' >> version.h; \
	  fi \
	fi
	@@echo '#define	LSOF_LDFLAGS	"${CFGL}"' >> version.h
	@@if [ "X${LSOF_LOGNAME}" = "X" ]; then \
	  echo '#define	LSOF_LOGNAME	"${LOGNAME}"' >> version.h; \
	else \
	  if [ "${LSOF_LOGNAME}" = "none" ]; then \
	    echo '#define	LSOF_LOGNAME	""' >> version.h; \
	  else \
	    echo '#define	LSOF_LOGNAME	"${LSOF_LOGNAME}"' >> version.h; \
	  fi; \
	fi
	@@if [ "X${LSOF_SYSINFO}" = "X" ]; then \
	    echo '#define	LSOF_SYSINFO	"'`uname -a`'"' >> version.h; \
	else \
	  if [ "${LSOF_SYSINFO}" = "none" ]; then \
	    echo '#define	LSOF_SYSINFO	""' >> version.h; \
	  else \
	    echo '#define	LSOF_SYSINFO	"${LSOF_SYSINFO}"' >> version.h; \
	  fi \
	fi
	@@if [ "X${LSOF_USER}" = "X" ]; then \
	  echo '#define	LSOF_USER	"${USER}"' >> version.h; \
	else \
	  if [ "${LSOF_USER}" = "none" ]; then \
	    echo '#define	LSOF_USER	""' >> version.h; \
	  else \
	    echo '#define	LSOF_USER	"${LSOF_USER}"' >> version.h; \
	  fi \
	fi
	@@sed '/VN/s/.ds VN \(.*\)/#define	LSOF_VERSION	"\1"/' < version >> version.h

FRC:

# DO NOT DELETE THIS LINE - make depend DEPENDS ON IT

ddev.o:		${HDR} ddev.c

dfile.o:	${HDR} dfile.c

dmnt.o:		${HDR} dmnt.c

dnode.o:	${HDR} dnode.c

dnode1.o:	${HDR} dnode1.c

dnode2.o:	${HDR} dnode2.c

dproc.o:	${HDR} kernelbase.h dproc.c

dsock.o:	${HDR} dsock.c

dstore.o:	${HDR} dstore.c

arg.o:		${HDR} arg.c

main.o:		${HDR} main.c

misc.o:		${HDR} misc.c

node.o:		${HDR} node.c

print.o:	${HDR} print.c

proc.o:		${HDR} proc.c

store.o:	${HDR} store.c

usage.o:	${HDR} version.h usage.c

util.o:		${HDR} util.c

# *** Do not add anything here - It will go away. ***
@


1.12
log
@Revision 4.60
@
text
@d4 1
a4 1
# $Id: Makefile,v 1.11 1999/11/28 06:44:28 abe Exp abe $
d22 1
a22 1
	arg.c main.c misc.c node.c print.c proc.c store.c usage.c
d26 1
a26 1
	arg.o main.o misc.o node.o print.o proc.o store.o usage.o
d158 2
@


1.11
log
@Revision 4.47
@
text
@d2 3
a4 1
# $Id: Makefile,v 1.10 99/04/19 14:39:04 abe Exp Locker: abe $
d75 1
a75 1
	@@sed '/VN/s/.ds VN \(.*\)/#define	LSOF_VERSION	"\1"/' < version > version.h
d81 9
d91 28
a118 4
	@@echo '#define	LSOF_LOGNAME	"${LOGNAME}"' >> version.h
	@@echo '#define	LSOF_HOST	"'`uname -n`'"' >> version.h
	@@echo '#define	LSOF_SYSINFO	"'`uname -a`'"' >> version.h
	@@echo '#define	LSOF_USER	"${USER}"' >> version.h
@


1.10
log
@Revision 4.43
Add Solaris install rule example.
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.9 99/02/25 20:00:29 abe Exp Locker: abe $
d57 1
a57 1
	@@echo '  install -[cf] <bin_dest> <options> -m 2755 -g kmem ${PROG}'
d68 1
a68 1
	(cd lib; ${MAKE} DEBUG="${DEBUG}")
@


1.9
log
@Revision 4.41
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.8 99/02/15 13:47:58 abe Exp Locker: abe $
d51 2
a52 2
	@@echo '  install <options> -m 2755 -g kmem ${PROG} <binary_destination>'
	@@echo '  install <options> -m 444 ${MAN} <man_destination>'
d54 6
d63 2
a64 2
	@@echo 'executable in <binary_destination>; the appropriate destination'
	@@echo 'for the man page in <man_destination>.'
@


1.8
log
@Revision 4.41
Add configuration info to version.h.
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.7 99/02/08 15:25:09 abe Exp Locker: abe $
d71 1
a71 1
	@@echo '#define	LSOF_CCFLAGS	"${CFLAGS}"' >> version.h
@


1.7
log
@Revision 4.41
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.6 98/02/16 19:55:02 abe Exp Locker: abe $
d72 1
@


1.6
log
@Revision 4.26
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.5 97/05/22 14:37:39 abe Exp Locker: abe $
a10 2
DEBUG=	-O

d14 1
a14 1
CFLAGS= ${DEBUG} ${CDEFS} ${INCL}
@


1.5
log
@Revision 4.08
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.4 97/04/29 14:16:12 abe Exp Locker: abe $
d21 2
a22 1
	dstore.c arg.c main.c misc.c node.c print.c proc.c store.c
d25 2
a26 1
	dstore.o arg.o main.o misc.o node.o print.o proc.o store.o
d102 1
a102 1
arg.o:		${HDR} version.h arg.c
d115 2
@


1.4
log
@Revision 4.06 addendum
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.3 97/04/29 08:26:06 abe Exp Locker: abe $
d42 1
a42 1
	(cd lib; make -f Makefile.skel clean)
d62 1
a62 1
	(cd lib; make DEBUG="${DEBUG}")
@


1.3
log
@Revision 4.06
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.2 97/03/06 13:03:25 abe Exp Locker: abe $
d42 1
a42 1
	(cd lib; make clean)
@


1.2
log
@Revision 4.02; add SHELL=/bin/sh string.
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.1 97/02/24 07:46:48 abe Exp Locker: abe $
d42 1
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
# $Id: Makefile,v 1.21 97/02/10 10:44:45 abe Exp $
d29 2
@
